<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Application</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîß Application Debug Report</h1>
    <button onclick="runDebugTests()">Run Debug Tests</button>
    <div id="debug-results"></div>

    <script src="frontend/script.js"></script>
    <script>
        function runDebugTests() {
            const results = document.getElementById('debug-results');
            results.innerHTML = '<h2>Running debug tests...</h2>';
            
            let html = '';
            let errors = [];
            
            // Test 1: Check if main classes exist
            html += '<div class="debug-section">';
            html += '<h3>1. Class Availability Test</h3>';
            
            const requiredClasses = [
                'LinguisticBridge',
                'VoiceInterface', 
                'IntentClassifier',
                'TranslationEngine',
                'PriceDiscoveryEngine',
                'NegotiationAssistant',
                'ResponseGenerator',
                'PrivacyManager',
                'AccessibilityManager',
                'CulturalContextManager'
            ];
            
            requiredClasses.forEach(className => {
                try {
                    if (typeof window[className] !== 'undefined') {
                        html += `‚úÖ ${className}: Available<br>`;
                    } else {
                        html += `‚ùå ${className}: Missing<br>`;
                        errors.push(`Missing class: ${className}`);
                    }
                } catch (error) {
                    html += `üí• ${className}: Error - ${error.message}<br>`;
                    errors.push(`Class error ${className}: ${error.message}`);
                }
            });
            html += '</div>';
            
            // Test 2: Try to instantiate main classes
            html += '<div class="debug-section">';
            html += '<h3>2. Class Instantiation Test</h3>';
            
            try {
                const voiceInterface = new VoiceInterface();
                html += '‚úÖ VoiceInterface: Can instantiate<br>';
            } catch (error) {
                html += `‚ùå VoiceInterface: ${error.message}<br>`;
                errors.push(`VoiceInterface instantiation: ${error.message}`);
            }
            
            try {
                const responseGenerator = new ResponseGenerator();
                html += '‚úÖ ResponseGenerator: Can instantiate<br>';
            } catch (error) {
                html += `‚ùå ResponseGenerator: ${error.message}<br>`;
                errors.push(`ResponseGenerator instantiation: ${error.message}`);
            }
            
            try {
                const intentClassifier = new IntentClassifier();
                html += '‚úÖ IntentClassifier: Can instantiate<br>';
            } catch (error) {
                html += `‚ùå IntentClassifier: ${error.message}<br>`;
                errors.push(`IntentClassifier instantiation: ${error.message}`);
            }
            
            html += '</div>';
            
            // Test 3: Check browser API support
            html += '<div class="debug-section">';
            html += '<h3>3. Browser API Support Test</h3>';
            
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                html += '‚úÖ Speech Recognition: Supported<br>';
            } else {
                html += '‚ùå Speech Recognition: Not supported<br>';
                errors.push('Speech Recognition API not supported');
            }
            
            if ('speechSynthesis' in window) {
                html += '‚úÖ Speech Synthesis: Supported<br>';
            } else {
                html += '‚ùå Speech Synthesis: Not supported<br>';
                errors.push('Speech Synthesis API not supported');
            }
            
            html += '</div>';
            
            // Test 4: Try basic functionality
            html += '<div class="debug-section">';
            html += '<h3>4. Basic Functionality Test</h3>';
            
            try {
                const responseGenerator = new ResponseGenerator();
                const testData = {
                    intent: { type: 'price_inquiry', product: 'test' },
                    priceData: { product: 'test', marketPrice: 50, unit: 'kg' },
                    negotiationGuidance: { confidence: 0.8, counterOffers: [], culturalContext: {} }
                };
                
                responseGenerator.formatResponse(testData, 'en-US').then(response => {
                    if (response && response.text) {
                        document.getElementById('func-test').innerHTML = '‚úÖ Response Generation: Working';
                    } else {
                        document.getElementById('func-test').innerHTML = '‚ùå Response Generation: No response text';
                        errors.push('Response generation produces no text');
                    }
                }).catch(error => {
                    document.getElementById('func-test').innerHTML = `‚ùå Response Generation: ${error.message}`;
                    errors.push(`Response generation error: ${error.message}`);
                });
                
                html += '<div id="func-test">‚è≥ Response Generation: Testing...</div>';
            } catch (error) {
                html += `‚ùå Response Generation: ${error.message}<br>`;
                errors.push(`Response generation test: ${error.message}`);
            }
            
            html += '</div>';
            
            // Test 5: Check DOM elements
            html += '<div class="debug-section">';
            html += '<h3>5. DOM Elements Test</h3>';
            
            const requiredElements = [
                'micButton',
                'language', 
                'listeningIndicator',
                'responseSection',
                'responseText',
                'statusMessage'
            ];
            
            requiredElements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element) {
                    html += `‚úÖ ${elementId}: Found<br>`;
                } else {
                    html += `‚ùå ${elementId}: Missing<br>`;
                    errors.push(`Missing DOM element: ${elementId}`);
                }
            });
            
            html += '</div>';
            
            // Test 6: Check for JavaScript errors
            html += '<div class="debug-section">';
            html += '<h3>6. JavaScript Console Errors</h3>';
            html += '<p>Check browser console for additional errors</p>';
            html += '</div>';
            
            // Summary
            html += '<div class="debug-section ' + (errors.length === 0 ? 'success' : 'error') + '">';
            html += '<h3>Summary</h3>';
            if (errors.length === 0) {
                html += '<p>‚úÖ No critical errors found!</p>';
            } else {
                html += `<p>‚ùå Found ${errors.length} errors:</p>`;
                html += '<ul>';
                errors.forEach(error => {
                    html += `<li>${error}</li>`;
                });
                html += '</ul>';
            }
            html += '</div>';
            
            results.innerHTML = html;
        }
        
        // Capture JavaScript errors
        window.addEventListener('error', function(e) {
            console.error('JavaScript Error:', e.error);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled Promise Rejection:', e.reason);
        });
    </script>
</body>
</html>